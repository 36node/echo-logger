{
	"info": {
		"_postman_id": "a749bab5-9b7c-4fca-96bf-b667d449768b",
		"name": "Draft Service",
		"schema": "https://schema.getpostman.com/json/collection/v2.1.0/collection.json"
	},
	"item": [
		{
			"name": "USER: 创建 DRAFT_A",
			"event": [
				{
					"listen": "test",
					"script": {
						"id": "e9461954-ee0b-42bb-9cf2-c0a92db9cfb2",
						"exec": [
							"var Ajv = require('ajv');",
							"var ajv = new Ajv({ logger: console, coerceTypes: true, unknownFormats: [\"int32\"] });",
							"",
							"pm.test(\"Status code is 201\", function () {",
							"  pm.response.to.have.status(201);",
							"});",
							"",
							"const schema = {\"type\":\"object\",\"required\":[],\"properties\":{\"content\":{\"allOf\":[{\"type\":\"object\",\"properties\":{\"resource\":{\"type\":\"string\"},\"type\":{\"type\":\"string\",\"enum\":[\"VEHICLE\",\"REPAIR\",\"MAINTAIN\"]},\"content\":{\"type\":\"string\"}}},{\"type\":\"object\",\"required\":[\"id\"],\"properties\":{\"id\":{\"type\":\"string\"},\"updateAt\":{\"type\":\"string\",\"format\":\"date-time\"},\"updateBy\":{\"type\":\"string\"},\"createAt\":{\"type\":\"string\",\"format\":\"date-time\"},\"createBy\":{\"type\":\"string\"}}}]}}};",
							"const res = {",
							"  content: pm.response.json(),",
							"  headers: pm.response.headers.reduce((c, k) => ({...c, [k.key]: k.value }), {})",
							"}",
							"pm.test(\"Json body schema test\", function(){",
							"  pm.expect(ajv.validate(schema, res)).to.be.true;",
							"})",
							"// 为后续测试准备数据",
							"pm.environment.set(\"DRAFT_A\", res.content.id);"
						],
						"type": "text/javascript"
					}
				}
			],
			"request": {
				"auth": {
					"type": "bearer",
					"bearer": [
						{
							"key": "token",
							"value": "{{token}}",
							"type": "string"
						}
					]
				},
				"method": "POST",
				"header": [
					{
						"key": "Accept",
						"value": "application/json"
					},
					{
						"key": "Content-Type",
						"value": "application/json"
					}
				],
				"body": {
					"mode": "raw",
					"raw": "{\r\n  \"resource\": \"xxxx\",\r\n  \"type\": \"VEHICLE\",\r\n  \"content\": \"contentxxx\",\r\n  \"createBy\": \"xxxx\",\r\n  \"ns\": \"xxx\"\r\n}"
				},
				"url": {
					"raw": "{{baseUrl}}/drafts",
					"host": [
						"{{baseUrl}}"
					],
					"path": [
						"drafts"
					]
				}
			},
			"response": [
				{
					"name": "Response_201",
					"originalRequest": {
						"auth": {
							"type": "bearer",
							"bearer": [
								{
									"key": "token",
									"value": "{{token}}",
									"type": "string"
								}
							]
						},
						"method": "POST",
						"header": [
							{
								"key": "Accept",
								"value": "application/json"
							},
							{
								"key": "Content-Type",
								"value": "application/json"
							}
						],
						"url": {
							"raw": "{{baseUrl}}/drafts",
							"host": [
								"{{baseUrl}}"
							],
							"path": [
								"drafts"
							]
						}
					},
					"status": "The draft created",
					"code": 201,
					"_postman_previewlanguage": "Text",
					"header": [
						{
							"key": "Content-type",
							"value": "application/json"
						}
					],
					"cookie": [],
					"body": ""
				}
			]
		},
		{
			"name": "USER: 获取 Draft 列表",
			"event": [
				{
					"listen": "test",
					"script": {
						"id": "4be6af0a-8fd1-423c-80d5-028378474b45",
						"exec": [
							"var Ajv = require('ajv');",
							"var ajv = new Ajv({ logger: console, coerceTypes: true, unknownFormats: [\"int32\"] });",
							"",
							"pm.test(\"Status code is 200\", function () {",
							"  pm.response.to.have.status(200);",
							"});",
							"",
							"const schema = {\"type\":\"object\",\"required\":[],\"properties\":{\"content\":{\"type\":\"array\",\"items\":{\"allOf\":[{\"type\":\"object\",\"properties\":{\"resource\":{\"type\":\"string\"},\"type\":{\"type\":\"string\",\"enum\":[\"VEHICLE\",\"REPAIR\",\"MAINTAIN\"]},\"content\":{\"type\":\"string\"}}},{\"type\":\"object\",\"required\":[\"id\"],\"properties\":{\"id\":{\"type\":\"string\"},\"updateAt\":{\"type\":\"string\",\"format\":\"date-time\"},\"updateBy\":{\"type\":\"string\"},\"createAt\":{\"type\":\"string\",\"format\":\"date-time\"},\"createBy\":{\"type\":\"string\"}}}]}},\"headers\":{\"type\":\"object\",\"required\":[\"X-Total-Count\"],\"properties\":{\"X-Total-Count\":{\"type\":\"integer\"}}}}};",
							"const res = {",
							"  content: pm.response.json(),",
							"  headers: pm.response.headers.reduce((c, k) => ({...c, [k.key]: k.value }), {})",
							"}",
							"pm.test(\"Json body schema test\", function(){",
							"  pm.expect(ajv.validate(schema, res)).to.be.true;",
							"})",
							""
						],
						"type": "text/javascript"
					}
				}
			],
			"request": {
				"auth": {
					"type": "bearer",
					"bearer": [
						{
							"key": "token",
							"value": "{{token}}",
							"type": "string"
						}
					]
				},
				"method": "GET",
				"header": [
					{
						"key": "Accept",
						"value": "application/json"
					}
				],
				"url": {
					"raw": "{{baseUrl}}/drafts?type=VEHICLE",
					"host": [
						"{{baseUrl}}"
					],
					"path": [
						"drafts"
					],
					"query": [
						{
							"key": "_limit",
							"value": "",
							"disabled": true
						},
						{
							"key": "_offset",
							"value": "",
							"disabled": true
						},
						{
							"key": "_sort",
							"value": "",
							"disabled": true
						},
						{
							"key": "_select",
							"value": "",
							"disabled": true
						},
						{
							"key": "type",
							"value": "VEHICLE"
						}
					]
				}
			},
			"response": [
				{
					"name": "Response_200",
					"originalRequest": {
						"auth": {
							"type": "bearer",
							"bearer": [
								{
									"key": "token",
									"value": "{{token}}",
									"type": "string"
								}
							]
						},
						"method": "GET",
						"header": [
							{
								"key": "Accept",
								"value": "application/json"
							}
						],
						"url": {
							"raw": "{{baseUrl}}/drafts?_limit=&_offset=&_sort=&_select=&type=",
							"host": [
								"{{baseUrl}}"
							],
							"path": [
								"drafts"
							],
							"query": [
								{
									"key": "_limit",
									"value": ""
								},
								{
									"key": "_offset",
									"value": ""
								},
								{
									"key": "_sort",
									"value": ""
								},
								{
									"key": "_select",
									"value": ""
								},
								{
									"key": "type",
									"value": ""
								}
							]
						}
					},
					"status": "A paged array of drafts",
					"code": 200,
					"_postman_previewlanguage": "Text",
					"header": [
						{
							"key": "Content-type",
							"value": "application/json"
						},
						{
							"key": "X-Total-Count",
							"value": "unset"
						}
					],
					"cookie": [],
					"body": ""
				}
			]
		},
		{
			"name": "USER: 获取 DRAFT_A",
			"event": [
				{
					"listen": "test",
					"script": {
						"id": "c5288542-98f1-4e25-bd82-6e32ab924e59",
						"exec": [
							"var Ajv = require('ajv');",
							"var ajv = new Ajv({ logger: console, coerceTypes: true, unknownFormats: [\"int32\"] });",
							"",
							"pm.test(\"Status code is 200\", function () {",
							"  pm.response.to.have.status(200);",
							"});",
							"",
							"const schema = {\"type\":\"object\",\"required\":[],\"properties\":{\"content\":{\"allOf\":[{\"type\":\"object\",\"properties\":{\"resource\":{\"type\":\"string\"},\"type\":{\"type\":\"string\",\"enum\":[\"VEHICLE\",\"REPAIR\",\"MAINTAIN\"]},\"content\":{\"type\":\"string\"}}},{\"type\":\"object\",\"required\":[\"id\"],\"properties\":{\"id\":{\"type\":\"string\"},\"updateAt\":{\"type\":\"string\",\"format\":\"date-time\"},\"updateBy\":{\"type\":\"string\"},\"createAt\":{\"type\":\"string\",\"format\":\"date-time\"},\"createBy\":{\"type\":\"string\"}}}]}}};",
							"const res = {",
							"  content: pm.response.json(),",
							"  headers: pm.response.headers.reduce((c, k) => ({...c, [k.key]: k.value }), {})",
							"}",
							"pm.test(\"Json body schema test\", function(){",
							"  pm.expect(ajv.validate(schema, res)).to.be.true;",
							"})",
							""
						],
						"type": "text/javascript"
					}
				}
			],
			"request": {
				"auth": {
					"type": "bearer",
					"bearer": [
						{
							"key": "token",
							"value": "{{token}}",
							"type": "string"
						}
					]
				},
				"method": "GET",
				"header": [
					{
						"key": "Accept",
						"value": "application/json"
					}
				],
				"url": {
					"raw": "{{baseUrl}}/drafts/:draftId",
					"host": [
						"{{baseUrl}}"
					],
					"path": [
						"drafts",
						":draftId"
					],
					"variable": [
						{
							"key": "draftId",
							"value": "{{DRAFT_A}}"
						}
					]
				}
			},
			"response": [
				{
					"name": "Response_200",
					"originalRequest": {
						"auth": {
							"type": "bearer",
							"bearer": [
								{
									"key": "token",
									"value": "{{token}}",
									"type": "string"
								}
							]
						},
						"method": "GET",
						"header": [
							{
								"key": "Accept",
								"value": "application/json"
							}
						],
						"url": {
							"raw": "{{baseUrl}}/drafts/:draftId",
							"host": [
								"{{baseUrl}}"
							],
							"path": [
								"drafts",
								":draftId"
							],
							"variable": [
								{
									"key": "draftId",
									"value": "{{draftId}}"
								}
							]
						}
					},
					"status": "Expected response to a valid request",
					"code": 200,
					"_postman_previewlanguage": "Text",
					"header": [
						{
							"key": "Content-type",
							"value": "application/json"
						}
					],
					"cookie": [],
					"body": ""
				}
			]
		},
		{
			"name": "USER: 修改 DRAFT_A",
			"event": [
				{
					"listen": "test",
					"script": {
						"id": "4ec7c6a6-5111-4669-b06a-47f371ef9e76",
						"exec": [
							"var Ajv = require('ajv');",
							"var ajv = new Ajv({ logger: console, coerceTypes: true, unknownFormats: [\"int32\"] });",
							"",
							"pm.test(\"Status code is 200\", function () {",
							"  pm.response.to.have.status(200);",
							"});",
							"",
							"const schema = {\"type\":\"object\",\"required\":[],\"properties\":{\"content\":{\"allOf\":[{\"type\":\"object\",\"properties\":{\"resource\":{\"type\":\"string\"},\"type\":{\"type\":\"string\",\"enum\":[\"VEHICLE\",\"REPAIR\",\"MAINTAIN\"]},\"content\":{\"type\":\"string\"}}},{\"type\":\"object\",\"required\":[\"id\"],\"properties\":{\"id\":{\"type\":\"string\"},\"updateAt\":{\"type\":\"string\",\"format\":\"date-time\"},\"updateBy\":{\"type\":\"string\"},\"createAt\":{\"type\":\"string\",\"format\":\"date-time\"},\"createBy\":{\"type\":\"string\"}}}]}}};",
							"const res = {",
							"  content: pm.response.json(),",
							"  headers: pm.response.headers.reduce((c, k) => ({...c, [k.key]: k.value }), {})",
							"}",
							"pm.test(\"Json body schema test\", function(){",
							"  pm.expect(ajv.validate(schema, res)).to.be.true;",
							"})",
							""
						],
						"type": "text/javascript"
					}
				}
			],
			"request": {
				"auth": {
					"type": "bearer",
					"bearer": [
						{
							"key": "token",
							"value": "{{token}}",
							"type": "string"
						}
					]
				},
				"method": "PUT",
				"header": [
					{
						"key": "Accept",
						"value": "application/json"
					},
					{
						"key": "Content-Type",
						"value": "application/json"
					}
				],
				"body": {
					"mode": "raw",
					"raw": "{\n  \"resource\": \"yyy\",\n  \"content\": \"contentYyyy\"\n}"
				},
				"url": {
					"raw": "{{baseUrl}}/drafts/:draftId",
					"host": [
						"{{baseUrl}}"
					],
					"path": [
						"drafts",
						":draftId"
					],
					"variable": [
						{
							"key": "draftId",
							"value": "{{DRAFT_A}}"
						}
					]
				}
			},
			"response": [
				{
					"name": "Response_200",
					"originalRequest": {
						"auth": {
							"type": "bearer",
							"bearer": [
								{
									"key": "token",
									"value": "{{token}}",
									"type": "string"
								}
							]
						},
						"method": "PUT",
						"header": [
							{
								"key": "Accept",
								"value": "application/json"
							},
							{
								"key": "Content-Type",
								"value": "application/json"
							}
						],
						"body": {
							"mode": "raw",
							"raw": "{\n  \"resource\": \"{{resource}}\",\n  \"type\": \"{{type}}\",\n  \"content\": \"{{content}}\"\n}"
						},
						"url": {
							"raw": "{{baseUrl}}/drafts/:draftId",
							"host": [
								"{{baseUrl}}"
							],
							"path": [
								"drafts",
								":draftId"
							],
							"variable": [
								{
									"key": "draftId",
									"value": "{{draftId}}"
								}
							]
						}
					},
					"status": "The draft",
					"code": 200,
					"_postman_previewlanguage": "Text",
					"header": [
						{
							"key": "Content-type",
							"value": "application/json"
						}
					],
					"cookie": [],
					"body": ""
				}
			]
		},
		{
			"name": "USER: 删除 DRAFT_A",
			"event": [
				{
					"listen": "test",
					"script": {
						"id": "ec6d2158-885f-49fb-a909-57c5f2292820",
						"exec": [
							"var Ajv = require('ajv');",
							"var ajv = new Ajv({ logger: console, coerceTypes: true, unknownFormats: [\"int32\"] });",
							"",
							"pm.test(\"Status code is 204\", function () {",
							"  pm.response.to.have.status(204);",
							"});",
							"",
							""
						],
						"type": "text/javascript"
					}
				}
			],
			"request": {
				"auth": {
					"type": "bearer",
					"bearer": [
						{
							"key": "token",
							"value": "{{token}}",
							"type": "string"
						}
					]
				},
				"method": "DELETE",
				"header": [
					{
						"key": "Accept",
						"value": "application/json"
					}
				],
				"url": {
					"raw": "{{baseUrl}}/drafts/:draftId",
					"host": [
						"{{baseUrl}}"
					],
					"path": [
						"drafts",
						":draftId"
					],
					"variable": [
						{
							"key": "draftId",
							"value": "{{DRAFT_A}}"
						}
					]
				}
			},
			"response": [
				{
					"name": "Response_204",
					"originalRequest": {
						"auth": {
							"type": "bearer",
							"bearer": [
								{
									"key": "token",
									"value": "{{token}}",
									"type": "string"
								}
							]
						},
						"method": "DELETE",
						"header": [
							{
								"key": "Accept",
								"value": "application/json"
							}
						],
						"url": {
							"raw": "{{baseUrl}}/drafts/:draftId",
							"host": [
								"{{baseUrl}}"
							],
							"path": [
								"drafts",
								":draftId"
							],
							"variable": [
								{
									"key": "draftId",
									"value": "{{draftId}}"
								}
							]
						}
					},
					"status": "draft deleted",
					"code": 204,
					"_postman_previewlanguage": "Text",
					"header": [],
					"cookie": [],
					"body": ""
				}
			]
		}
	],
	"protocolProfileBehavior": {}
}